import{c as d,n as m,S as p,d as c}from"./helper-DPa9qwI8.js";document.addEventListener("DOMContentLoaded",function(){const u=$("#table-url").val(),h=$("#asset-url").val();$("#table").DataTable({order:[[0,"desc"]],ordering:!0,serverSide:!0,processing:!0,autoWidth:!1,responsive:!0,ajax:{url:u,data:function(l){l.status_test_letter=$("#status-filter").val()??"",l.workshop_type=$("#workshop-type-filter").val()??"",l.date_range=$("#date-range").val()??""}},language:{search:"Cari:",paginate:{first:"Pertama",last:"Terakhir",next:"Berikutnya",previous:"Sebelumnya"},info:"Menampilkan halaman _PAGE_ dari _PAGES_",infoEmpty:"Tidak ada data yang tersedia",infoFiltered:"(Terfilter dari _MAX_ jumlah data)",lengthMenu:"Tampilkan _MENU_ data per halaman",emptyTable:`<div class="text-center"><img class="mb-3" width="200" src="${h+"assets/dist/img/undraw_no_data_re_kwbl.svg"}"><p>Data Masih Kosong</p></div>`,zeroRecords:`<div class="text-center"><img class="mb-3" width="200" src="${h+"assets/dist/img/undraw_not_found_re_bh2e.svg"}"><p>Data Tidak Ditemukan</p></div>`},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",width:"40px",orderable:!1,searchable:!1},{data:"test_letter.code",name:"test_letter.code",className:"text-nowrap",orderable:!1,searchable:!0},{data:"user.name",name:"user.name",className:"text-nowrap",orderable:!1,searchable:!0},{data:"brand",name:"brand",className:"text-nowrap",orderable:!1,searchable:!0},{data:"test_letter.workshop",name:"test_letter.workshop",className:"text-nowrap",orderable:!1,searchable:!0},{data:"test_letter.workshop_type",name:"test_letter.workshop_type",className:"text-nowrap",orderable:!1,searchable:!0},{data:"status",name:"status",className:"text-nowrap",orderable:!1,searchable:!0},{data:"action",name:"action",className:"text-nowrap",orderable:!1,searchable:!1}],columnDefs:[{responsivePriority:1,targets:0},{responsivePriority:2,targets:1}]}),$("#btn-apply-filter").on("click",function(){$("#table").DataTable().ajax.reload()}),$("#date-range").daterangepicker({autoUpdateInput:!1,showCustomRangeLabel:!0,locale:{format:"YYYY-MM-DD",applyLabel:"Pilih",cancelLabel:"Bersihkan"},opens:"left",ranges:{"Hari Ini":[moment(),moment()],"Minggu Ini":[moment().startOf("week"),moment().endOf("week")],"Bulan Ini":[moment().startOf("month"),moment().endOf("month")]}}),$("#date-range").on("apply.daterangepicker",function(l,n){const r=n.startDate.format("YYYY-MM-DD"),e=n.endDate.format("YYYY-MM-DD");$(this).val(`${r} - ${e}`),$("#table").DataTable().ajax.reload()}),$("#date-range").on("cancel.daterangepicker",function(){$(this).val(""),$("#table").DataTable().ajax.reload()}),$("#btn-export").on("click",function(){let l=new FormData;const n=$("#date-range").val(),r=$("#status-filter").val(),e=$("#workshop-type-filter").val();l.append("date_range",n),l.append("status",r),l.append("type",e);const o=$("#export-url").val();$("#btn-export").empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:l}).then(a=>a.json()).then(a=>{if(console.log(a),a.code==200&&fetch(a.data.download).then(t=>t.blob()).then(t=>{const s=window.URL.createObjectURL(t),i=document.createElement("a");i.href=s,i.download=a.data.file_name,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(s)}),a.errors||a.invalid)for(let t in a.errors){for(let s in a.errors[t])$("[name="+t+"]").addClass("is-invalid");$("[name="+t+"]").keypress(function(){$("[name="+t+"]").removeClass("is-invalid")}),$("[name="+t+"]").change(function(){$("[name="+t+"]").removeClass("is-invalid")})}}).catch(a=>{console.log("Error:",a)}).finally(()=>{$("#btn-export").empty().append(`
                    Export
                `).prop("disabled",!1)})}),$("#form-certificate").submit(function(l){l.preventDefault(),$("#id").val();let n=new FormData(this),r="#btn-submit",e=$("#certificate-form-url").val();$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(e,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(o=>o.json()).then(o=>{if(o.code==200&&(m(o.message),setTimeout(()=>{window.location.href=o.data.redirect},2e3)),o.code==403&&(p.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-danger"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path><path d="M12 8v4"></path><path d="M12 16h.01"></path></svg>
                            <h3>Terjadi Kesalahan</h3>
        <div>${o.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#d63939",customClass:{confirmButton:"btn btn-success w-100"}}),$(r).empty().append(o.data.button).prop("disabled",!1)),o.errors||o.invalid){new c(o.errors||o.invalid);let a=!1;$.each(o.errors,function(t){const s=$(`[name="${t}"]`);if(s.length&&!a){const i=$(".row-cards"),f=s.offset().top-i.offset().top-100;i.animate({scrollTop:i.scrollTop()+f},500),s.focus(),a=!0}}),$(r).empty().append("Simpan").prop("disabled",!1);return}}).catch(o=>{console.log("Error:",o)}).finally(()=>{$(r).empty().append("Simpan").prop("disabled",!1)})}),$("#btn-download-certificate-srut").click(function(){let l=$("#download-certificate-srut-url").val(),n=new FormData;n.append("id",$("#id").val());let r="#btn-download-certificate-srut";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(e=>e.json()).then(e=>{e.code==200&&fetch(e.data.download).then(o=>o.blob()).then(o=>{const a=window.URL.createObjectURL(o),t=document.createElement("a");t.href=a,t.download=e.data.file_name,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a)}),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append(`
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon mx-0 icon-tabler icons-tabler-outline icon-tabler-download"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
                `).prop("disabled",!1)})}),$("#btn-download-certificate-sut").click(function(){let l=$("#download-certificate-sut-url").val(),n=new FormData;n.append("id",$("#id").val());let r="#btn-download-certificate-sut";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(e=>e.json()).then(e=>{e.code==200&&fetch(e.data.download).then(o=>o.blob()).then(o=>{const a=window.URL.createObjectURL(o),t=document.createElement("a");t.href=a,t.download=e.data.file_name,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a)}),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append(`
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon mx-0 icon-tabler icons-tabler-outline icon-tabler-download"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
                `).prop("disabled",!1)})}),$("#btn-download-certificate-attachment").click(function(){let l=$("#download-certificate-attachment-url").val(),n=new FormData;n.append("id",$("#id").val());let r="#btn-download-certificate-attachment";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(e=>e.json()).then(e=>{e.code==200&&fetch(e.data.download).then(o=>o.blob()).then(o=>{const a=window.URL.createObjectURL(o),t=document.createElement("a");t.href=a,t.download=e.data.file_name,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a)}),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append(`
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon mx-0 icon-tabler icons-tabler-outline icon-tabler-download"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
                `).prop("disabled",!1)})}),$("#btn-download-sk").click(function(){let l=$("#download-sk-url").val(),n=new FormData;n.append("id",$("#id").val());let r="#btn-download-sk";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(e=>e.json()).then(e=>{e.code==200&&fetch(e.data.download).then(o=>o.blob()).then(o=>{const a=window.URL.createObjectURL(o),t=document.createElement("a");t.href=a,t.download=e.data.file_name,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a)}),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append(`
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon mx-0 icon-tabler icons-tabler-outline icon-tabler-download"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
                `).prop("disabled",!1)})}),$("#btn-send-draft").click(function(){let l=$("#send-draft-url").val(),n=new FormData;n.append("id",$("#id").val());let r="#btn-send-draft";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(e=>e.json()).then(e=>{e.code==200&&(p.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),window.location.reload()),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append(`
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-send mx-0"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 14l11 -11" /><path d="M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5" /></svg>
                `).prop("disabled",!1)})}),$("#btn-verification").click(function(){let l=$("#verify-url").val(),n=new FormData;n.append("id",$("#id").val());let r="#btn-verification";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(e=>e.json()).then(e=>{e.code==200&&(p.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),setTimeout(function(){window.location.href=e.data.redirect},1e3)),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append("Verifikasi").prop("disabled",!1)})}),$("#btn-upload-archive").click(function(){let l=$("#upload-archive-url").val(),n=new FormData;if($("#workshop_type").val()=="A"&&$("#test_letter_step").val()!="create_certificate_srut"){let t=document.getElementById("type_test_attachment").files[0],s=document.getElementById("sk_attachment").files[0];n.append("sk_attachment",s),n.append("type_test_attachment",t),n.append("workshop_type","A")}if($("#workshop_type").val()=="A"&&$("#test_letter_step").val()=="create_certificate_srut"){let t=document.getElementById("registration_attachment").files[0];n.append("registration_attachment",t),n.append("workshop_type","A"),n.append("test_letter_step",$("#test_letter_step").val()),n.append("old_type_test_attachment",$("#old_type_test_attachment").val())}if($("#workshop_type").val()=="B"){let t=document.getElementById("sk_attachment").files[0],s=document.getElementById("registration_attachment").files[0],i=document.getElementById("type_test_attachment").files[0];n.append("sk_attachment",t),n.append("registration_attachment",s),n.append("type_test_attachment",i)}let r=$("#id").val(),e=$("#certificate_id").val(),o=$("#user-id").val(),a="#btn-upload-archive";n.append("conversion_id",r),n.append("user_id",o),n.append("id",e),$(a).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(t=>t.json()).then(t=>{t.code==200&&(p.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${t.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),$("#btn-approve").empty().append("Selesai").prop("disabled",!1),window.location.href=t.data.redirect),(t.errors||t.invalid)&&new c(t.errors||t.invalid)}).catch(t=>{console.log("Error:",t)}).finally(()=>{$(a).empty().append('<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="mx-0 icon icon-tabler icons-tabler-outline icon-tabler-upload"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 9l5 -5l5 5" /><path d="M12 4l0 12" /></svg>').prop("disabled",!1)})}),$("#btn_request_testing").click(function(){let l=$("#request-testing-url").val(),n=new FormData,r=$("#test_letter_id").val(),e=$("#id").val(),o="#btn_request_testing";n.append("id",e),n.append("test_letter_id",r),$(o).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(l,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:n}).then(a=>a.json()).then(a=>{if(a.code==200&&(p.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${a.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),window.location.reload()),a.errors||a.invalid){new c(a.errors||a.invalid);return}}).catch(a=>{console.log("Error:",a)}).finally(()=>{$(o).empty().append("Request Hasil Uji").prop("disabled",!1)})})});
