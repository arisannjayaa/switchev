import{g,c,S as d,b as w,s as b,h as m,i as k,j as y}from"./helper-BjVJ0fku.js";document.addEventListener("DOMContentLoaded",function(){const u=$("#table-url").val(),f=$("#asset-url").val();var p;$("#check-all").change(function(){$("#check-all:checked").length===$("#check-all").length?$("input[value='Sesuai']").prop("checked",!0):$("input[value='Sesuai']").prop("checked",!1)}),$("#modal-reject").on("hidden.bs.modal",function(){y(p,"#editor-reject")}),$("#table").DataTable({order:[[0,"desc"]],ordering:!0,serverSide:!0,processing:!0,autoWidth:!1,responsive:!0,ajax:{url:u},language:{search:"Cari:",paginate:{first:"Pertama",last:"Terakhir",next:"Berikutnya",previous:"Sebelumnya"},info:"Menampilkan halaman _PAGE_ dari _PAGES_",infoEmpty:"Tidak ada data yang tersedia",infoFiltered:"(Terfilter dari _MAX_ jumlah data)",lengthMenu:"Tampilkan _MENU_ data per halaman",emptyTable:`<div class="text-center"><img class="mb-3" width="200" src="${f+"assets/dist/img/undraw_no_data_re_kwbl.svg"}"><p>Data Masih Kosong</p></div>`,zeroRecords:`<div class="text-center"><img class="mb-3" width="200" src="${f+"assets/dist/img/undraw_not_found_re_bh2e.svg"}"><p>Data Tidak Ditemukan</p></div>`},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",width:"40px",orderable:!1,searchable:!1},{data:"person_responsible",name:"person_responsible",className:"text-nowrap",orderable:!1,searchable:!0},{data:"workshop",name:"workshop",className:"text-nowrap",orderable:!1,searchable:!0},{data:"whatapp_responsible",name:"whatapp_responsible",className:"text-nowrap",orderable:!1,searchable:!0},{data:"type",name:"type",className:"text-nowrap",orderable:!1,searchable:!0},{data:"status",name:"status",className:"text-nowrap",orderable:!1,searchable:!0,render:function(n){return`<span class="badge bg-primary text-primary-fg">${g(n)}</span>`}},{data:"action",name:"action",className:"text-nowrap",orderable:!1,searchable:!1}],columnDefs:[{responsivePriority:1,targets:0},{responsivePriority:2,targets:1}]}),$("#type").val()==="Selain Sepeda Motor"&&$("#select-wiring-diagram").show(),$("#type").change(function(){$(this).val()==="Selain Sepeda Motor"?$("#select-wiring-diagram").show():$("#select-wiring-diagram").hide()}),$("#application_letter").change(function(){$('[name="old_application_letter"]').length&&$('[name="old_application_letter"]').remove()}),$("#technician_competency").change(function(){$('[name="old_technician_competency"]').length&&$('[name="old_technician_competency"]').remove()}),$("#equipment").change(function(){$('[name="old_equipment"]').length&&$('[name="old_equipment"]').remove()}),$("#sop").change(function(){$('[name="old_sop"]').length&&$('[name="old_sop"]').remove()}),$("#wiring_diagram").change(function(){$('[name="old_wiring_diagram"]').length&&$('[name="old_wiring_diagram"]').remove()}),$("#form-conversion").submit(function(n){n.preventDefault(),$("#id").val();let o=new FormData(this),t="#btn-next",a=$("#step").val(),i;console.log(a),a==1&&(i=$("#form-responsible-url").val()),a==2&&(i=$("#form-document-url").val()),a==3&&(i=$("#form-mechanical-url").val()),a==4&&(i=$("#form-equipment-url").val()),$(t).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(i,{method:"POST",headers:{"X-CSRF-TOKEN":c()},body:o}).then(e=>e.json()).then(e=>{e.code==200&&(window.location.href=e.data.redirect),e.code==403&&(d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-danger"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path><path d="M12 8v4"></path><path d="M12 16h.01"></path></svg>
                            <h3>Terjadi Kesalahan</h3>
        <div>${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#d63939",customClass:{confirmButton:"btn btn-success w-100"}}),$(t).empty().append(e.data.button).prop("disabled",!1)),(e.errors||e.invalid)&&(new w(e.errors||e.invalid),$(t).empty().append("Selanjutnya").prop("disabled",!1))}).catch(e=>{console.log("Error:",e)}).finally(()=>{})}),$("#table").on("click",".detail",function(){let n=$(this).data("id"),o=$("#show-url").val();o=o.replace(":id",n),window.location.href=o}),$("#form-checklist-equipment").submit(function(n){n.preventDefault();let o=new FormData(this),t="#btn-checklist-confirm",a="#modal-checklist-equipment",i=$("#checklist-url").val();$(t).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(i,{method:"POST",headers:{"X-CSRF-TOKEN":c()},body:o}).then(e=>e.json()).then(e=>{e.code==200&&($(a).modal("hide"),d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}})),(e.errors||e.invalid)&&b(e.errors),window.location.reload()}).catch(e=>{console.log("Error:",e)}).finally(()=>{m(1e3),$(t).empty().append("Simpan").prop("disabled",!1)})}),$("#btn-approve").click(function(){let n=$("#id").val(),o=$("#approve-url").val(),t=$("#btn-approve"),a=$("#step").val();o=o.replace(":id",n);let i=new FormData;i.append("id",n),$(t).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),d.fire({html:`<svg  xmlns="http://www.w3.org/2000/svg"  width="100"  height="100"  viewBox="0 0 24 24"  fill="currentColor"  class="mb-2 text-info"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 2c5.523 0 10 4.477 10 10a10 10 0 0 1 -19.995 .324l-.005 -.324l.004 -.28c.148 -5.393 4.566 -9.72 9.996 -9.72zm0 9h-1l-.117 .007a1 1 0 0 0 0 1.986l.117 .007v3l.007 .117a1 1 0 0 0 .876 .876l.117 .007h1l.117 -.007a1 1 0 0 0 .876 -.876l.007 -.117l-.007 -.117a1 1 0 0 0 -.764 -.857l-.112 -.02l-.117 -.006v-3l-.007 -.117a1 1 0 0 0 -.876 -.876l-.117 -.007zm.01 -3l-.127 .007a1 1 0 0 0 0 1.986l.117 .007l.127 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z" /></svg>
                    <h3>Apakah anda yakin</h3>
                    <div class="text-secondary" style="font-size: 14px !important;">Apakah anda sudah yakin dari data ini?</div>`,confirmButtonText:"Verifikasi",cancelButtonText:"Batal",customClass:{confirmButton:"btn btn-info w-100",cancelButton:"btn w-100"},showCancelButton:!0}).then(e=>{if(e.isDismissed){a==4?$(t).empty().append("Selesai").prop("disabled",!1):$(t).empty().append("Verifikasi").prop("disabled",!1);return}if(e.isConfirmed){if(a==3){$("#modal-checklist-equipment").modal("show");return}fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":c()},body:i}).then(s=>s.json()).then(s=>{s.code==200&&(d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                            <h3>Berhasil</h3>
                            <div class="text-secondary">${s.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),setTimeout(function(){location.reload()},2e3)),a==4?$(t).empty().append("Selesai").prop("disabled",!1):$(t).empty().append("Verifikasi").prop("disabled",!1)}).catch(s=>{console.log("Error:",s)}).finally(()=>{})}m(1e3)})}),$("#btn-reject").click(function(){let n=$("#id").val(),o=$("#reject-url").val();o=o.replace(":id",n);let t=new FormData;t.append("id",n),d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-danger"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 9v4"></path><path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z"></path><path d="M12 16h.01"></path></svg>
                    <h3>Apakah anda yakin</h3>
                    <div class="text-secondary" style="font-size: 14px !important;">Apakah Anda benar ingin menolak data ini?</div>`,confirmButtonText:"Tolak",cancelButtonText:"Batal",customClass:{confirmButton:"btn btn-danger w-100",cancelButton:"btn w-100"},showCancelButton:!0}).then(a=>{if(a.isConfirmed){$("#modal-reject").modal("show"),p=new Quill("#editor-reject",{theme:"snow"});const i="#btn-reject-confirm";$("#btn-reject-confirm").off("click").on("click",function(){k(i);let e=p.root.innerHTML,s=p.getText().trim();t.append("message",e),t.append("nohtml",s),fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":c()},body:t}).then(l=>l.json()).then(l=>{if(l.code==200&&(d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                            <h3>Berhasil</h3>
                            <div class="text-secondary">${l.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),setTimeout(function(){location.reload()},2e3)),l.errors||l.invalid){let h=l.errors||l.invalid;$(".invalid-feedback").remove();for(let r in h){for(let v in h[r])$("[key="+r+"]").addClass("is-invalid").after('<div class="text-left invalid-feedback">'+h[r][v]+"</div>");$("[key="+r+"]").keypress(function(){$("[key="+r+"]").removeClass("is-invalid")}),$("[key="+r+"]").change(function(){$("[key="+r+"]").removeClass("is-invalid")})}}}).catch(l=>{console.log("Error:",l)}).finally(()=>{$(i).empty().append("Konfirmasi").prop("disabled",!1)})})}m(1e3)})}),$("#btn-send-mail").click(function(){let n=$("#id").val(),o=quill.root.innerHTML,t=$("#mail-url").val();t=t.replace(":id",n);let a=new FormData,i="#btn-send-mail",e=$("#step").val(),s="";e==2&&(s="Jadwal Verifikasi Zoom"),e==3&&(s="Jadwal Verifikasi Lapangan"),a.append("id",n),a.append("message",o),a.append("title",s),$(i).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(t,{method:"POST",headers:{"X-CSRF-TOKEN":c()},body:a}).then(l=>l.json()).then(l=>{l.code==200&&d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${l.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),$(i).empty().append("Kirim")}).catch(l=>{console.log("Error:",l)}).finally(()=>{$(i).empty().append("Kirim")})})});
