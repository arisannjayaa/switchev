import{c as d,d as c,S as p}from"./helper-DPa9qwI8.js";document.addEventListener("DOMContentLoaded",function(){const f=$("#table-url").val(),h=$("#asset-url").val();$("#table").DataTable({order:[[0,"desc"]],ordering:!0,serverSide:!0,processing:!0,autoWidth:!1,responsive:!0,ajax:{url:f,data:function(o){o.status_conversion=$("#status-filter").val()??"",o.workshop_type=$("#workshop-type-filter").val()??"",o.date_range=$("#date-range").val()??""}},language:{search:"Cari:",paginate:{first:"Pertama",last:"Terakhir",next:"Berikutnya",previous:"Sebelumnya"},info:"Menampilkan halaman _PAGE_ dari _PAGES_",infoEmpty:"Tidak ada data yang tersedia",infoFiltered:"(Terfilter dari _MAX_ jumlah data)",lengthMenu:"Tampilkan _MENU_ data per halaman",emptyTable:`<div class="text-center"><img class="mb-3" width="200" src="${h+"assets/dist/img/undraw_no_data_re_kwbl.svg"}"><p>Data Masih Kosong</p></div>`,zeroRecords:`<div class="text-center"><img class="mb-3" width="200" src="${h+"assets/dist/img/undraw_not_found_re_bh2e.svg"}"><p>Data Tidak Ditemukan</p></div>`},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",width:"40px",orderable:!1,searchable:!1},{data:"conversion.type",name:"conversion.type",className:"text-nowrap",orderable:!1,searchable:!0},{data:"conversion.certificate_code",name:"conversion.certificate_code",className:"text-nowrap",orderable:!1,searchable:!0},{data:"conversion.sk_code",name:"conversion.sk_code",className:"text-nowrap",orderable:!1,searchable:!0},{data:"status",name:"status",className:"text-nowrap",orderable:!1,searchable:!0},{data:"action",name:"action",className:"text-nowrap",orderable:!1,searchable:!1}],columnDefs:[{responsivePriority:1,targets:0},{responsivePriority:2,targets:1}]});const u=$("#is-certificate-ready").val();$("#btn-approve").prop("disabled",!0),u==1&&$("#btn-approve").prop("disabled",!1),$("#btn-apply-filter").on("click",function(){$("#table").DataTable().ajax.reload()}),$("#date-range").daterangepicker({autoUpdateInput:!1,showCustomRangeLabel:!0,locale:{format:"YYYY-MM-DD",applyLabel:"Pilih",cancelLabel:"Bersihkan"},opens:"left",ranges:{"Hari Ini":[moment(),moment()],"Minggu Ini":[moment().startOf("week"),moment().endOf("week")],"Bulan Ini":[moment().startOf("month"),moment().endOf("month")]}}),$("#date-range").on("apply.daterangepicker",function(o,t){const r=t.startDate.format("YYYY-MM-DD"),e=t.endDate.format("YYYY-MM-DD");$(this).val(`${r} - ${e}`),$("#table").DataTable().ajax.reload()}),$("#date-range").on("cancel.daterangepicker",function(){$(this).val(""),$("#table").DataTable().ajax.reload()}),$("#btn-export").on("click",function(){let o=new FormData;const t=$("#date-range").val(),r=$("#status-filter").val(),e=$("#workshop-type-filter").val();o.append("date_range",t),o.append("status",r),o.append("type",e);const s=$("#export-url").val();$("#btn-export").empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(s,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:o}).then(a=>a.json()).then(a=>{if(console.log(a),a.code==200&&fetch(a.data.download).then(n=>n.blob()).then(n=>{const i=window.URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=a.data.file_name,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(i)}),a.errors||a.invalid)for(let n in a.errors){for(let i in a.errors[n])$("[name="+n+"]").addClass("is-invalid");$("[name="+n+"]").keypress(function(){$("[name="+n+"]").removeClass("is-invalid")}),$("[name="+n+"]").change(function(){$("[name="+n+"]").removeClass("is-invalid")})}}).catch(a=>{console.log("Error:",a)}).finally(()=>{$("#btn-export").empty().append(`
                    Export
                `).prop("disabled",!1)})}),$("#btn-download-sk").click(function(){let o=$("#download-sk-url").val(),t=new FormData;t.append("id",$("#id").val()),t.append("accreditation_type",$("#accreditation_type").val());let r="#btn-download-sk";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:t}).then(e=>e.json()).then(e=>{e.code==200&&fetch(e.data.download).then(s=>s.blob()).then(s=>{const a=window.URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download=e.data.file_name,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(a)}),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append(`
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon mx-0 icon-tabler icons-tabler-outline icon-tabler-download"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
                `).prop("disabled",!1)})}),$("#btn-download-certificate").click(function(){let o=$("#download-certificate-url").val(),t=new FormData;t.append("id",$("#id").val()),t.append("accreditation_type",$("#accreditation_type").val());let r="#btn-download-certificate";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:t}).then(e=>e.json()).then(e=>{e.code==200&&fetch(e.data.download).then(s=>s.blob()).then(s=>{const a=window.URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download=e.data.file_name,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(a)}),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append(`
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon mx-0 icon-tabler icons-tabler-outline icon-tabler-download"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
                `).prop("disabled",!1)})}),$("#btn-upload-archive").click(function(){let o=$("#upload-archive-url").val(),t=new FormData,r=document.getElementById("sk_attachment").files[0],e=document.getElementById("sft_attachment").files[0],s=$("#id").val(),a=$("#certificate_id").val(),n=$("#user-id").val(),i="#btn-upload-archive";t.append("sk_attachment",r),t.append("sft_attachment",e),t.append("conversion_id",s),t.append("user_id",n),t.append("user_id",n),t.append("id",a),$(i).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:t}).then(l=>l.json()).then(l=>{l.code==200&&(p.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${l.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),$("#btn-approve").empty().append("Selesai").prop("disabled",!1),window.location.href=l.data.redirect),(l.errors||l.invalid)&&new c(l.errors||l.invalid)}).catch(l=>{console.log("Error:",l)}).finally(()=>{$(i).empty().append('<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="mx-0 icon icon-tabler icons-tabler-outline icon-tabler-upload"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 9l5 -5l5 5" /><path d="M12 4l0 12" /></svg>').prop("disabled",!1)})}),$("#btn-verification").click(function(){let o=$("#verify-url").val(),t=new FormData;t.append("id",$("#id").val());let r="#btn-verification";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:t}).then(e=>e.json()).then(e=>{e.code==200&&(p.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),setTimeout(function(){window.location.href=e.data.redirect},1e3)),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append("Verifikasi").prop("disabled",!1)})}),$("#btn-send-draft").click(function(){let o=$("#send-draft-url").val(),t=new FormData;t.append("id",$("#id").val()),t.append("accreditation_type",$("#accreditation_type").val());let r="#btn-send-draft";$(r).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":d()},body:t}).then(e=>e.json()).then(e=>{e.code==200&&(p.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),window.location.reload()),(e.errors||e.invalid)&&new c(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(r).empty().append(`
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-send mx-0"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 14l11 -11" /><path d="M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5" /></svg>
                `).prop("disabled",!1)})})});
