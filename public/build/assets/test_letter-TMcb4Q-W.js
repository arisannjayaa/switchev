import{g,m as b,S as d,k as _,c as p,h as m,d as v,r as k}from"./helper-DPa9qwI8.js";document.addEventListener("DOMContentLoaded",function(){const w=$("#table-url").val(),f=$("#asset-url").val();$("#table").DataTable({order:[[0,"desc"]],ordering:!0,serverSide:!0,processing:!0,autoWidth:!1,responsive:!0,ajax:{url:w},language:{search:"Cari:",paginate:{first:"Pertama",last:"Terakhir",next:"Berikutnya",previous:"Sebelumnya"},info:"Menampilkan halaman _PAGE_ dari _PAGES_",infoEmpty:"Tidak ada data yang tersedia",infoFiltered:"(Terfilter dari _MAX_ jumlah data)",lengthMenu:"Tampilkan _MENU_ data per halaman",emptyTable:`<div class="text-center"><img class="mb-3" width="200" src="${f+"assets/dist/img/undraw_no_data_re_kwbl.svg"}"><p>Data Masih Kosong</p></div>`,zeroRecords:`<div class="text-center"><img class="mb-3" width="200" src="${f+"assets/dist/img/undraw_not_found_re_bh2e.svg"}"><p>Data Tidak Ditemukan</p></div>`},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",width:"40px",orderable:!1,searchable:!1},{data:"code",name:"code",className:"text-nowrap",orderable:!1,searchable:!0},{data:"workshop_type",name:"workshop_type",className:"text-nowrap",orderable:!1,searchable:!0},{data:"status",name:"status",className:"text-nowrap",orderable:!1,searchable:!0,render:function(n){return'<span class="">'+g(n).status}},{data:"action",name:"action",className:"text-nowrap",orderable:!1,searchable:!1}],columnDefs:[{responsivePriority:1,targets:0},{responsivePriority:2,targets:1}]});var c;$("#modal-reject").on("hidden.bs.modal",function(){b(c,"#editor-reject")}),$("#btn-reject").click(function(){let n=$("#id").val(),t=$("#reject-url").val();t=t.replace(":id",n);let a=new FormData;a.append("id",n),d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-danger"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 9v4"></path><path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z"></path><path d="M12 16h.01"></path></svg>
                    <h3>Apakah anda yakin</h3>
                    <div class="text-secondary" style="font-size: 14px !important;">Apakah Anda benar ingin menolak data ini?</div>`,confirmButtonText:"Tolak",cancelButtonText:"Batal",customClass:{confirmButton:"btn btn-danger w-100",cancelButton:"btn w-100"},showCancelButton:!0}).then(i=>{if(i.isConfirmed){$("#modal-reject").modal("show"),c=new Quill("#editor-reject",{theme:"snow"});const s="#btn-reject-confirm";$("#btn-reject-confirm").off("click").on("click",function(){_(s);let e=c.root.innerHTML,h=c.getText().trim();a.append("message",e),a.append("nohtml",h),fetch(t,{method:"POST",headers:{"X-CSRF-TOKEN":p()},body:a}).then(o=>o.json()).then(o=>{if(o.code==200&&(d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                            <h3>Berhasil</h3>
                            <div class="text-secondary">${o.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),setTimeout(function(){window.location.href=o.data.redirect},2e3)),o.errors||o.invalid){let r=o.errors||o.invalid;$(".invalid-feedback").remove();for(let l in r){for(let u in r[l])$("[key="+l+"]").addClass("is-invalid").after('<div class="text-left invalid-feedback">'+r[l][u]+"</div>");$("[key="+l+"]").keypress(function(){$("[key="+l+"]").removeClass("is-invalid")}),$("[key="+l+"]").change(function(){$("[key="+l+"]").removeClass("is-invalid")})}}}).catch(o=>{console.log("Error:",o)}).finally(()=>{$(s).empty().append("Konfirmasi").prop("disabled",!1)})})}m(1e3)})}),$("#workshop_type").change(function(){$(".sut-attachment").remove(),$(".quality-attachment").remove(),$("#is_have_srut").remove(),$(this).val()=="A"&&$("#modal-q").modal("show")}),$("#btn-apply-submit").on("click",function(){let n=$('input[name="is_have_sut"]:checked').val(),t=$("#secure_file").val();t=t.replace(":path","dGllVVRVaVd5ZlpLTVp5bHJtVU01dElEWXFyNk9zdmM3RDZwcTU2Q2xCbEZOT2V1akRUcFBVdDlCUVZpak5pRg=="),n==1&&($('input[name="id"]').after('<input type="hidden" id="is_have_sut" name="is_have_sut" value="1">'),$(".row.row-cards").append(`
                <div class="col-lg-6 col-12 sut-attachment">
                            <div class="mb-3">
                                <label class="form-label required">Lampiran Sertifikat SUT</label>
                                <input id="type_test_attachment" type="file" class="form-control" name="type_test_attachment">
                                <small class="form-hint">
                                    Lampiran Sertifikat SUT.
                                </small>
                            </div>
                        </div>
                <div class="col-lg-6 col-12 quality-attachment">
                    <div class="mb-3">
                        <label class="form-label required">Lampiran Quality Control</label>
                        <input id="quality_control" type="file" class="form-control" name="quality_control">
                        <small class="form-hint">
                            Lampiran Quality Control. <br>
                             Format dokumen tersedia dapat di unduh <a target="_blank" href="${t}">Disini</a>
                        </small>
                    </div>
                </div>
           `)),$("#modal-q").modal("hide")}),$("#sop_component_installation").change(function(){$('[name="old_sop_component_installation"]').length&&$('[name="old_sop_component_installation"]').remove()}),$("#technical_drawing").change(function(){$('[name="old_technical_drawing"]').length&&$('[name="old_technical_drawing"]').remove()}),$("#conversion_workshop_certificate").change(function(){$('[name="old_conversion_workshop_certificate"]').length&&$('[name="old_conversion_workshop_certificate"]').remove()}),$("#electrical_diagram").change(function(){$('[name="old_electrical_diagram"]').length&&$('[name="old_electrical_diagram"]').remove()}),$("#photocopy_stnk").change(function(){$('[name="old_photocopy_stnk"]').length&&$('[name="old_photocopy_stnk"]').remove()}),$("#physical_inspection").change(function(){$('[name="old_physical_inspection"]').length&&$('[name="old_physical_inspection"]').remove()}),$("#test_report").change(function(){$('[name="old_test_report"]').length&&$('[name="old_test_report"]').remove()}),$("#form-test-letter").submit(function(n){n.preventDefault(),$("#id").val();let t=new FormData(this),a="#btn-submit",i=$("#upsert-form-url").val();$("#is_have_sut").val()==1&&(i=$("#upsert-form-have-sut-url").val()),$(a).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),fetch(i,{method:"POST",headers:{"X-CSRF-TOKEN":p()},body:t}).then(e=>e.json()).then(e=>{if(e.code==200&&(window.location.href=e.data.redirect),e.code==403&&(d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-danger"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path><path d="M12 8v4"></path><path d="M12 16h.01"></path></svg>
                            <h3>Terjadi Kesalahan</h3>
        <div>${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#d63939",customClass:{confirmButton:"btn btn-success w-100"}}),$(a).empty().append(e.data.button).prop("disabled",!1)),e.errors||e.invalid){new v(e.errors||e.invalid);let h=!1;$.each(e.errors,function(o){const r=$(`[name="${o}"]`);if(r.length&&!h){const l=$(".row-cards"),u=r.offset().top-l.offset().top-100;l.animate({scrollTop:l.scrollTop()+u},500),r.focus(),h=!0}}),$(a).empty().append("Ajukan Pendaftaran").prop("disabled",!1)}}).catch(e=>{console.log("Error:",e)}).finally(()=>{})}),$("#table").on("click",".detail",function(){let n=$(this).data("id"),t=$("#show-url").val();t=t.replace(":id",n),window.location.href=t}),$(".modal-pyhsical-test").click(function(){let n=$(this).data("id"),t=$("#show-physical-test-url").val();t=t.replace(":id",n),fetch(t,{method:"GET"}).then(a=>a.json()).then(a=>{a.code==200&&($(".modal-title").empty().append("Upload Hasil Uji Fisik BPLJSKB"),$("#id").val(a.data.id),$("#modal-test-physical").modal("show"),k())}).catch(a=>{console.log("Error:",a)}).finally(()=>{m(1e3)})}),$("#form-test-physical").submit(function(n){n.preventDefault();let t=new FormData(this),a="#btn-upload-physical-test",i="#modal-test-physical",s=$("#upload-physical-test-url").val();$(a).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`),fetch(s,{method:"POST",headers:{"X-CSRF-TOKEN":p()},body:t}).then(e=>e.json()).then(e=>{e.code==200&&($(i).modal("hide"),d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                    <h3>Berhasil</h3>
                    <div class="text-secondary">${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),window.location.reload()),(e.errors||e.invalid)&&new v(e.errors||e.invalid)}).catch(e=>{console.log("Error:",e)}).finally(()=>{m(1e3),$(a).empty().append("Upload")})}),$("#btn-approve").click(function(){let n=$("#id").val(),t=$("#approve-url").val(),a=$("#btn-approve"),i=new FormData;$("#is_have_sut").val()==1&&(t=$("#approve-srut-url").val()),i.append("id",n),i.append("is_verified",1),$(a).empty().append(`<div class="spinner-border" role="status">
                                <span class="visually-hidden">Loading...</span>
                                </div>`).prop("disabled",!0),d.fire({html:`<svg  xmlns="http://www.w3.org/2000/svg"  width="100"  height="100"  viewBox="0 0 24 24"  fill="currentColor"  class="mb-2 text-info"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 2c5.523 0 10 4.477 10 10a10 10 0 0 1 -19.995 .324l-.005 -.324l.004 -.28c.148 -5.393 4.566 -9.72 9.996 -9.72zm0 9h-1l-.117 .007a1 1 0 0 0 0 1.986l.117 .007v3l.007 .117a1 1 0 0 0 .876 .876l.117 .007h1l.117 -.007a1 1 0 0 0 .876 -.876l.007 -.117l-.007 -.117a1 1 0 0 0 -.764 -.857l-.112 -.02l-.117 -.006v-3l-.007 -.117a1 1 0 0 0 -.876 -.876l-.117 -.007zm.01 -3l-.127 .007a1 1 0 0 0 0 1.986l.117 .007l.127 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z" /></svg>
                    <h3>Apakah anda yakin</h3>
                    <div class="text-secondary" style="font-size: 14px !important;">Apakah anda sudah yakin dari data ini?</div>`,confirmButtonText:"Verifikasi",cancelButtonText:"Batal",customClass:{confirmButton:"btn btn-info w-100",cancelButton:"btn w-100"},showCancelButton:!0}).then(s=>{s.isDismissed&&$(a).empty().append("Verifikasi").prop("disabled",!1),s.isConfirmed&&fetch(t,{method:"POST",headers:{"X-CSRF-TOKEN":p()},body:i}).then(e=>e.json()).then(e=>{e.code==200&&(d.fire({html:`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 text-green"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M9 12l2 2l4 -4"></path></svg>
                            <h3>Berhasil</h3>
                            <div class="text-secondary">${e.message}</div>`,confirmButtonText:"Ok",confirmButtonColor:"#2fb344",customClass:{confirmButton:"btn btn-success w-100"}}),setTimeout(function(){window.location.href=e.data.redirect},2e3))}).catch(e=>{console.log("Error:",e)}).finally(()=>{$(a).empty().append("Verifikasi").prop("disabled",!0)}),m(1e3)})})});
